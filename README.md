# Smart School Diary

## Название и краткое описание
**Smart School Diary** — это учебный планировщик с веб-интерфейсом и REST API для школьного дневника. Проект помогает вести предметы и расписание, отслеживать домашние задания, напоминания и субъективную сложность/настроение по заданиям, а также смотреть аналитику учебной нагрузки. В кодовой базе также есть модуль поиска учебных материалов. На практике это закрывает типичную проблему «разрозненных заметок» и собирает учебные задачи в едином рабочем контуре.

## Стек технологий
- **Backend:** Python, FastAPI, SQLAlchemy (async), Alembic, asyncpg, Uvicorn.
- **Frontend:** TypeScript, Next.js (App Router), React, Zustand, Tailwind CSS.
- **База данных:** PostgreSQL.
- **Инфраструктура:** Docker, Docker Compose.
- **Тестирование:** pytest (backend), Vitest и Playwright (frontend).

## Структура проекта
- `backend/` — серверная часть на FastAPI.
  - `app/main.py` — создание приложения, CORS, подключение общего роутера API.
  - `app/api/v1/` — сборка v1 API и health-check.
  - `app/routers/` — HTTP-роутеры предметов, расписания, ДЗ, напоминаний, настроения, аналитики, материалов.
  - `app/models/`, `app/schemas/`, `app/crud/`, `app/services/` — модели БД, схемы, операции доступа к данным и сервисная логика.
  - `alembic/` — миграции БД.
- `frontend/` — клиентская часть на Next.js.
  - `app/` — страницы (`/schedule`, `/homework`, `/reminders`, `/analytics`, `/materials`).
  - `components/` — UI-компоненты по доменам.
  - `lib/api-client.ts` и `lib/mock-api-client.ts` — работа с реальным и mock API.
- `docker-compose.yml` — запуск `postgres`, `backend`, `frontend` как отдельных сервисов.

## Установка и запуск
Минимальный вариант через Docker Compose:
1. Из корня проекта выполнить:
   ```bash
   docker compose up --build
   ```
2. После запуска сервисы доступны по адресам:
   - Frontend: `http://localhost:3000`
   - Backend API: `http://localhost:8000`

Для переменных окружения в проекте есть примеры:
- `backend/.env.example`
- `frontend/.env.example`

## Основные сущности / модули
Ядро backend строится вокруг доменных моделей:
- **Subject** — учебный предмет.
- **ScheduleSlot** — слот расписания (день недели, время, кабинет, предмет).
- **Homework** и **HomeworkStep** — задание и его шаги выполнения.
- **Reminder** — напоминание по домашнему заданию.
- **MoodEntry** — отметка сложности/настроения (уровни `easy/normal/hard`) с привязкой к дате и, опционально, к заданию.

## API / точки входа
Приложение подключает API с префиксом `/api`, а основные роутеры реализованы как:
- `/api/health`
- `/api/v1/subjects`
- `/api/v1/schedule`
- `/api/v1/homework`
- `/api/v1/reminders`
- `/api/v1/mood`
- `/api/v1/analytics` (в т.ч. `/load`, `/warnings`)
- `/api/v1/materials/search`

## Экстра-фичи и уникальные возможности (помимо MVP)
Ниже перечислены функции, которые делают проект «умным ассистентом», а не просто цифровым списком задач:

1. **Умное разбиение большого ДЗ на шаги (AI Smart Planner)**
   - Для каждого задания можно сгенерировать пошаговый план выполнения.
   - Шаги сохраняются и отмечаются как выполненные по мере прогресса.
   - Это снижает эффект «сложного старта» и помогает ученику идти маленькими итерациями.

2. **AI-подбор учебных материалов по теме задания**
   - По теме ДЗ и предмету система предлагает релевантные материалы (видео/статьи/источники).
   - Если AI-провайдер недоступен, используется fallback‑поиск, чтобы функция оставалась рабочей.

3. **Трекер сложности и аналитика учебной нагрузки**
   - После выполнения задания ученик отмечает субъективную сложность: `easy / normal / hard`.
   - На основе накопленных данных формируется аналитика недели и предупреждения о перегрузке.
   - Пример логики предупреждения: слишком много «сложных» предметов в один день подряд.

4. **Централизованные напоминания + просмотр pending-уведомлений**
   - Напоминания привязываются к конкретным заданиям и времени.
   - Есть endpoint и UI-слой для просмотра «ожидающих» напоминаний, чтобы не терять дедлайны.

5. **Готовность к демо и офлайн-разработке**
   - Frontend поддерживает переключение между реальным API и mock API через переменные окружения.
   - Это удобно для демонстрации и параллельной работы над UI/Backend.

## Как организаторам самостоятельно развернуть приложение

### Вариант A (рекомендуется): Docker Compose
Этот способ поднимает все сервисы сразу (`postgres`, `backend`, `frontend`) и подходит для быстрой проверки жюри.

1. **Клонировать репозиторий и перейти в папку проекта**
   ```bash
   git clone <repo_url>
   cd smart-school-diary-hackathon
   ```

2. **Подготовить переменные окружения**
   - Backend:
     ```bash
     cp backend/.env.example backend/.env
     ```
   - Frontend:
     ```bash
     cp frontend/.env.example frontend/.env
     ```

   По умолчанию этого достаточно для локального запуска.

   Опционально для расширенных AI-функций:
   - заполнить `OPENROUTER_API_KEY` в `backend/.env`;
   - заполнить `YOUTUBE_API_KEY` в `backend/.env`.

3. **Запустить проект**
   ```bash
   docker compose up --build
   ```

4. **Проверить доступность сервисов**
   - Frontend: `http://localhost:3000`
   - Backend API: `http://localhost:8000`
   - Swagger/OpenAPI: `http://localhost:8000/docs`

5. **Остановить сервисы**
   ```bash
   docker compose down
   ```

### Вариант B: локальный запуск без Docker (для разработчиков)

#### 1) Backend
```bash
cd backend
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
cp .env.example .env
alembic upgrade head
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

#### 2) Frontend
В новом терминале:
```bash
cd frontend
npm install
cp .env.example .env
npm run dev
```

После запуска:
- Frontend: `http://localhost:3000`
- Backend: `http://localhost:8000`

## Инструкция по использованию приложения

Ниже базовый пользовательский сценарий, который удобно показывать на демо.

1. **Откройте дашборд**
   - Перейдите на `http://localhost:3000`.
   - С главной страницы доступны быстрые переходы к ключевым разделам.

2. **Добавьте предметы**
   - Перейдите в раздел предметов/расписания.
   - Создайте предметы (например: Математика, Физика, История).

3. **Соберите расписание**
   - В разделе расписания добавьте слоты по дням недели и времени.
   - Привяжите каждый слот к предмету.

4. **Создайте домашние задания**
   - Откройте раздел **Homework**.
   - Для каждого задания задайте тему, описание, предмет и дедлайн.

5. **Запустите «умное планирование»**
   - Для большого задания нажмите генерацию шагов.
   - Получившийся план используйте как чек-лист, отмечая шаги по мере выполнения.

6. **Настройте напоминания**
   - В разделе **Reminders** выберите задание и время напоминания.
   - Проверяйте pending-напоминания через интерфейс, чтобы не пропускать сроки.

7. **Отмечайте выполнение и сложность**
   - По завершении задания помечайте его как выполненное.
   - Выберите уровень сложности (`easy / normal / hard`) и при необходимости добавьте заметку.

8. **Смотрите аналитику нагрузки**
   - В разделе **Analytics** изучайте недельную картину нагрузки.
   - Обращайте внимание на предупреждения о потенциальной перегрузке.

9. **Используйте поиск материалов для подготовки**
   - В разделе **Materials** введите тему/запрос.
   - Изучите подобранные источники и AI-рекомендацию.

## Что реализовано по TASK.md
- MVP-функции: расписание, домашние задания, отметка выполнения, напоминания, веб-интерфейс.
- «Умное» ядро: генерация шагов для больших задач, трекер сложности, аналитика нагрузки с предупреждениями.
- Дополнительная фича «Помощник в подготовке»: подбор материалов по теме задания.

> Примечание: пункты геймификации (очки/ачивки) и групповой работы отмечены в задаче как дополнительные идеи для развития и могут быть добавлены в следующих итерациях.
